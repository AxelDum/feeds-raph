<%
-- Copyright 2015 OVH (OverTheBox@ovh.net)
-- Simon Lelievre (simon.lelievre@corp.ovh.com)
-- Sebastien Duponcheel (sebastien.duponcheel@ovh.net)
--
-- This file is part of OverTheBox for OpenWrt.
--
--    OverTheBox is free software: you can redistribute it and/or modify
--    it under the terms of the GNU General Public License as published by
--    the Free Software Foundation, either version 3 of the License, or
--    (at your option) any later version.
--
--    OverTheBox is distributed in the hope that it will be useful,
--    but WITHOUT ANY WARRANTY; without even the implied warranty of
--    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
--    GNU General Public License for more details.
--
--    You should have received a copy of the GNU General Public License
--    along with OverTheBox.  If not, see (http://www.gnu.org/licenses/)
-%>
<%
	local uci = require("luci.model.uci").cursor()

	local device_id = uci:get("overthebox", "me", "device_id")
	local service = uci:get("overthebox", "me", "service")
%>

<script type="text/javascript" src="<%=resource%>/cbi.js"></script>
<script type="text/javascript">//<![CDATA[

stepbar.register.status = "warn";

var stxhr = new XHR();
function activate_service(service)
{
	stxhr.get('<%=luci.dispatcher.build_url("admin", "overthebox", "activate")%>/' + service, null,
		function(x)
		{
			window.setTimeout(function() {
				location.href='<%=luci.dispatcher.build_url("admin/overthebox/overview")%>';
			}, 1000);
		}
	);
}
//]]></script>

<h2><%:Register your device%></h2>
<fieldset id="activate_button_field" class="cbi-section">
<!--	<legend><%:Register your device%></legend>-->
        <table width="100%" cellspacing="10">
		<tr><td width="33%"><%:Device ID%></td><td><%=device_id or "?"%></td></tr>
		<tr><td width="33%"><%:Register URL%></td><td><a href="https://www.ovh.com/manager/sunrise/login/" target="_blank">https://www.ovh.com/manager/sunrise/login/</a></td></tr>
        </table>

	<div id="activate_action_button" class="cbi-page-actions">
		<input type="button" onclick="window.open('https://www.ovh.com/manager/sunrise/login/')" value="<%:Register%>" class="cbi-button cbi-button-apply" />
		<img id="img-loader" style="display:none" src="<%=resource%>/icons/loading.gif" alt="<%:Loading%>" height="20" />
	</div>
</fieldset>

